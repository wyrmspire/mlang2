"""
NewTestRsiBounceScanner Strategy
Generated by scripts/create_strategy.py
"""

from src.policy.scanners import Scanner, ScanResult
from src.features.state import MarketState
from src.features.pipeline import FeatureBundle
from typing import Dict, Any

class NewTestRsiBounceScanner(Scanner):
    """
    TODO: Add description of your strategy here.
    """

    @property
    def scanner_id(self) -> str:
        return "new_test_rsi_bounce"

    def scan(self, state: MarketState, features: FeatureBundle) -> ScanResult:
        """
        Check for entry conditions on every bar.
        
        Available data:
        - state.timestamp, state.current_price, state.last_close
        - features.indicators (RSI, EMA, etc.)
        """
        
        # Custom Logic for RSI Bounce
        # Buy when RSI < 30 (oversold)
        rsi = features.indicators.rsi_5m_14
        
        triggered = False
        context = {}
        
        if rsi < 30:
            triggered = True
            context = {
                "direction": "LONG",
                "reason": f"RSI oversold: {rsi:.2f}",
                "entry_price": state.current_price
            }

        return ScanResult(
            scanner_id=self.scanner_id,
            triggered=triggered,
            context=context,
            score=1.0 if triggered else 0.0
        )
